<!DOCTYPE html>
<html lang="en">
 <head>
 <meta charset="utf-8">

 <meta name="viewport" content="width=device-width,
initial-scale=1.0">
 <meta name="description" content="">
 <meta name="author" content="">
 <!-- CSS -->
 <link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Open+Sans:400i
talic,400">
 <link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Droid+Sans">
 <link rel="stylesheet"
href="http://fonts.googleapis.com/css?family=Lobster">
 <link rel="stylesheet"
href="assets/bootstrap/css/bootstrap.min.css">
 <link rel="stylesheet"
href="assets/prettyPhoto/css/prettyPhoto.css">
 <link rel="stylesheet"
href="assets/css/flexslider.css">
 <link rel="stylesheet" href="assets/css/fontawesome.css">
 <link rel="stylesheet" href="assets/css/style.css">
 <!-- HTML5 shim, for IE6-8 support of HTML5
elements -->
 <!--[if lt IE 9]>
 <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></
script>
 <![endif]-->
 <!-- Favicon and touch icons -->
 <link rel="shortcut icon"
href="assets/ico/favicon.ico">
 <link rel="apple-touch-icon-precomposed"
sizes="144x144" href="assets/ico/apple-touch-icon-144-
precomposed.png">
 <link rel="apple-touch-icon-precomposed"
sizes="114x114" href="assets/ico/apple-touch-icon-114precomposed.png">
 <link rel="apple-touch-icon-precomposed"
sizes="72x72" href="assets/ico/apple-touch-icon-72-
precomposed.png">
 <link rel="apple-touch-icon-precomposed"
href="assets/ico/apple-touch-icon-57-precomposed.png">

 <script src="jquery-mobile/jquery-1.6.4.min.js"
type="text/javascript"></script>
 <script src="jquery-mobile/jquery.mobile1.0.min.js" type="text/javascript"></script>
 <script src="ChartNew.js"></script>
 </head>
 <body onLoad="populateUsers();">
 <!-- Header -->
 <div class="container violetbg" style="position:
fixed !important; width: 320px;">
 <div class="header row" style="margin-top:
20px;">
 <div class="span12">
 <div class="navbar">
 <div class="navbar-inner"
style="background-color:#206489">
 <a class="btn btn-navbar" datatoggle="collapse" data-target=".nav-collapse">
 <span class="iconbar"></span>
<span class="iconbar"></span>
<span class="iconbar"></span>
 </a>
<div class="presentation
container" style="float:left; margin-top:-11px;">
 <h2><div
style="color:white">Mobile Audiometry App</div></h2>

 </div>
<div class="nav-collapse
collapse">
 <ul class="nav pull-right"
>
 <li>
 <a href="index.html" rel="external"><i class="iconhome"></i><br />Home</a>
 </li>
<li>
 <a
href="takeTest.html" rel="external"><i class="iconcamera"></i><br />Take Test</a>
 </li>
<li class="currentpage">
 <a
href="viewHistory.html" rel="external"><i class="iconcomments"></i><br />View History</a>
 </li>
<li>
 <a href="FAQ.html"
rel="external"><i class="icon-tasks"></i><br />FAQ</a>
 </li>
 </ul>
 </div>
 </div>
 </div>
 </div>
 <div id="key" class="span12" style="fontsize: 12px; color: #000000; background-color: #FFFFFF
!important; padding-bottom: 20px; display:
none;"><br/>Hearing Loss Level: <br/>
 <font style="background-color:
#A6FFBE;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;</font>
 &nbsp;&nbsp;&nbsp;<font style="backgroundcolor:
#FFFFA6;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mild&nbsp;&nb
sp;&nbsp;&nbsp;&nbsp;&nbsp;</font>
 &nbsp;&nbsp;&nbsp;<font style="backgroundcolor: #FFD5A6;">&nbsp;Moderate&nbsp;</font>
 &nbsp;&nbsp;&nbsp;<font style="backgroundcolor:
#FFB2A6;">&nbsp;&nbsp;&nbsp;&nbsp;Severe&nbsp;&nbsp;&nbsp;&
nbsp;</font></div>
 </div>

 </div>
 <br/><br/><br/><br/><br/><br/>

 <!--<div id="key" style="color: #000000; position:
fixed !important; background-color: #FFFFFF; padding-top: 5px; padding-bottom: 5px; display: none; width: 100%;
padding-left: -100px;">Hearing Loss Level: <br/><font
style="background-color:
#000000;">&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;&nbsp;&nbsp;&nb
sp;</font>
 <font style="background-color:
#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mild&nbsp;&nbsp;&nb
sp;&nbsp;&nbsp;</font>
 <font style="background-color:
#000000;">Moderate</font>
 <font style="background-color:
#000000;">&nbsp;&nbsp;&nbsp;Severe&nbsp;&nbsp;&nbsp;</font>
<br/></div>-->

 <div id="selectProfile" class="violet"
style="height: 430px; font-size: 17px;">
 <br/><br/><br/>
 Select Profile:
 <br/><br/><br/>

 <select id="theUser">

 </select>

 <br/><br/><br/>

 <a href="#" onClick="viewHistory();"
class="nextBtn">View History</a>
 </div>


 <div id="results" style="display:none">


 </div>

 <div id="footer" class="row"> </div>
 <!-- Javascript -->
 <script>
 $.mobile.loadingMessage = false;

var user;
var database =
window.openDatabase("MAAData1", "1.0",
"MobileAudiometryAppData1", 1000000);

 function populateUsers(){

document.getElementById("key").style.display="none";
 database.transaction(loadNames, queryError,
openSuccess);
 }

 function loadNames(tx)
 {
 //alert("0");
tx.executeSql('CREATE TABLE IF NOT EXISTS
maa (name varchar(255) NOT NULL PRIMARY KEY, dates
varchar(8000), data varchar(8000))');
 tx.executeSql('SELECT name FROM maa', [],
querySuccess, queryError);
 }


 function querySuccess(tx, results)
 {

 var divContent =
document.getElementById("theUser");
 var len = results.rows.length;
 for(var i = 0; i<len; i++)
{
 var option =
document.createElement("option");
 option.text =
results.rows.item(i).name;
 option.value =
results.rows.item(i).name;
 divContent.add(option);
 }

 }

 function queryError(err)
 {
 alert("Error: " + err);
 }

 function openSuccess()
 {
 //alert("success!");

 }function displayResults(tx)
 {
 //alert("in displayResults");
 tx.executeSql("SELECT dates, data FROM maa
WHERE name='" + user + "'", [], findResults, queryError);
 //alert("finished dispaly results");
 }

 function findResults(tx, results)
 {
 // var length = results.length;
 var data1 = results.rows.item(0).data;
 var dates1 = results.rows.item(0).dates;
var myData = data1.split('.');
 var myDate = dates1.split('.');

for(var i = 0; i<myData.length-1; i++)
 {
 var chartName = "myChart" + i;

document.getElementById("results").innerHTML +=
'<br/><br/><canvas id="' + chartName + '" data-type="Line"
width="250" height="350"></canvas>';
 }

for(var i = 0; i < myData.length - 1; i++)
 {
 var myDatai = myData[i].split(",");
var myDatei = myDate[i];
var chartName = "myChart" + i;
//document.getElementById("results").innerHTML +=
'<br/><br/><canvas id="' + chartName + '" data-type="Line"
width="250" height="350"></canvas>';

var ctx =
document.getElementById(chartName).getContext("2d");

//alert(myDatai);
var data = {
 labels :
["250","500","1000","2000","4000","8000"],
 datasets : [
 {
fillColor :
"rgba(255,178,166,1)",
strokeColor : "rgba(255,178,166,1)",
 pointColor :
"rgba(255,178,166,1)",
 pointStrokeColor :
"#fff",
 data :
[80,80,80,80,80,80]
},
{
fillColor :
"rgba(255,213,166,1)",
strokeColor :
"rgba(255,213,166,1)",
pointColor :
"rgba(255,213,166,1)",
pointStrokeColor :
"#fff",
 data :
[70,70,70,70,70,70]
 },
{
fillColor :
"rgba(255,255,166,1)",
strokeColor :
"rgba(255,255,166,1)",
 pointColor :
"rgba(255,255,166,1)",
 pointStrokeColor :
"#fff",
data :
[40,40,40,40,40,40]
},
 {
 fillColor :
"rgba(166,255,190,1)",
strokeColor :
"rgba(166,255,190,1)",
pointColor :
"rgba(166,255,190,1)",
 pointStrokeColor :
"#fff",
 data :
[20,20,20,20,20,20]
},
{
fillColor :
"rgba(255,255,255,0.6)",strokeColor :
"rgba(136,136,136,1)",
pointColor :
"rgba(255,255,255,1)",
pointStrokeColor :
"#fff",
data : myDatai
}
 ]
 }
 var options1 = {
 scaleOverride : true,
scaleSteps : 8,
scaleStepWidth : 10,
scaleStartValue : 0,
scaleOverlay : true,
scaleFontSize : 12,
scaleFontFamily : "'Open Sans'",
yAxisLeft : true,
yAxisLabel : "Decibel Hearing
Level",
 xAxisLabel : "Frequency (Hz)",
xAxisFontFamily : "'Open Sans'",
 yAxisFontFamily : "'Open Sans'",
 xAxisFontSize : 12,
yAxisFontSize : 12,
pointDot : false,
graphTitle : " " + myDatei
 }

 //alert();
var myNewChart = new
Chart(ctx).Line(data, options1);

document.getElementById("key").style.display="inlineblock";
 }

//alert("end of findResults");

 }
function viewHistory(){
var inputBox =
document.getElementById("theUser");
user =
inputBox.options[inputBox.selectedIndex].text;
document.getElementById('selectProfile').style.display
= "none";
document.getElementById('results').style.display =
"inline";
 // alert("User: " + user);
 database.transaction(displayResults,
queryError, openSuccess)
}


</script>
 <script src="assets/js/jquery1.8.2.min.js"></script>
 <script
src="assets/bootstrap/js/bootstrap.min.js"></script>
 <script
src="assets/js/jquery.flexslider.js"></script>
 <script src="assets/js/jquery.tweet.js"></script>
 <script src="assets/js/jflickrfeed.js"></script>
 <script
src="http://maps.google.com/maps/api/js?sensor=true"></scri
pt>
 <script
src="assets/js/jquery.ui.map.min.js"></script>
 <script
src="assets/js/jquery.quicksand.js"></script>
 <script
src="assets/prettyPhoto/js/jquery.prettyPhoto.js"></script>
 <script src="assets/js/scripts.js"></script>
 </body>
</html>
